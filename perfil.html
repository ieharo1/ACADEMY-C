<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil | AcademyC</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="icon" type="image/png" href="assets/img/linux_32.png">
    <style>
        .profile-container { min-height: calc(100vh - 80px); display: flex; align-items: center; justify-content: center; padding: 40px 20px; }
        .profile-card { background: var(--card-bg); padding: 50px; border-radius: 24px; box-shadow: var(--shadow-lg); width: 100%; max-width: 500px; border: 1px solid var(--border); text-align: center; }
        .profile-avatar { width: 80px; height: 80px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 32px; margin: 0 auto 20px; font-weight: 800; }
        .form-group { text-align: left; margin-bottom: 20px; }
        .form-group label { display: block; font-weight: 700; font-size: 14px; margin-bottom: 8px; color: var(--text-dark); }
        .form-group input { width: 100%; padding: 14px 20px; border: 2px solid var(--border); border-radius: 12px; background: var(--bg-light); color: var(--text-dark); font-family: inherit; font-size: 16px; }
    </style>
</head>
<body>
    <header class="navbar">
        <div class="container nav-content">
            <div class="logo-area"><a href="index.html" class="brand"><span class="logo-icon"><i class="fas fa-graduation-cap"></i></span><span class="logo-text">AcademyC</span></a></div>
            <nav class="nav-links" id="main-nav">
                <ul>
                    <li><a href="index.html">Inicio</a></li>
                    <li><a href="cursos.html">Cursos</a></li>
                    <li><a href="precios.html">Precios</a></li>
                    <li class="dropdown">
                        <a href="javascript:void(0)" class="dropbtn">Miembro <i class="fas fa-chevron-down"></i></a>
                        <div class="dropdown-content"></div>
                    </li>
                </ul>
            </nav>
            <div class="nav-auth" id="nav-auth">
                <button class="theme-toggle" id="theme-toggle"><i class="fas fa-moon"></i></button>
                <div id="auth-buttons"></div>
            </div>
            <button class="mobile-menu-btn" id="mobile-btn"><i class="fas fa-bars"></i></button>
        </div>
    </header>

    <main class="profile-container">
        <div class="profile-card">
            <div class="profile-avatar" id="p-avatar">U</div>
            <h1 style="color: var(--text-dark); margin-bottom: 30px;">Editar Perfil</h1>
            <form id="p-form">
                <div class="form-group">
                    <label>Nombre Completo</label>
                    <input type="text" id="p-name" required>
                </div>
                <div class="form-group">
                    <label>Correo Electrónico</label>
                    <input type="email" id="p-email" disabled style="opacity: 0.5; cursor: not-allowed;">
                </div>
                <div class="form-group">
                    <label>Nueva Contraseña (opcional)</label>
                    <input type="password" id="p-pass" placeholder="Dejar en blanco para no cambiar">
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%; padding: 16px; font-size: 16px; margin-top: 10px;">Actualizar Información</button>
            </form>
        </div>
    </main>

    <script src="assets/js/index.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            if (!user) { window.location.href = 'iniciarsesion.html'; return; }

            // Load current data
            document.getElementById('p-name').value = user.name;
            document.getElementById('p-email').value = user.email;
            document.getElementById('p-avatar').innerText = user.name.charAt(0).toUpperCase();

            // Save changes
            document.getElementById('p-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const newName = document.getElementById('p-name').value;
                const newPass = document.getElementById('p-pass').value;

                let users = JSON.parse(localStorage.getItem('users') || '[]');
                const idx = users.findIndex(u => u.email === user.email);

                if (idx !== -1) {
                    users[idx].name = newName;
                    if (newPass) {
                        if (newPass.length < 6) { alert('La contraseña debe tener al menos 6 caracteres.'); return; }
                        users[idx].password = newPass;
                    }
                    localStorage.setItem('users', JSON.stringify(users));
                    localStorage.setItem('currentUser', JSON.stringify(users[idx]));
                    alert('¡Perfil actualizado con éxito!');
                    window.location.reload();
                }
            });
        });
    </script>
</body>
</html>
